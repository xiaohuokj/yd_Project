<template>
    <div class="archives">
      <span class="top_left"></span>
      <span class="top_left2"></span>
      <span class="top_left3"></span>
      <span class="top_left4"></span>
      <div class="archives_check">
          <div class="clearfix">
              <p class="el-icon-date archives_check_p">生产养殖</p> 
          </div>
          <div class="clearfix">
              <div class="archives_content clearfix">
                  <p class="content_p">牛舍编号：</p>
                 <!-- <select class="content_input" v-model="cowshedNum" @change="getCouponSelected($event)">
					  <option v-for="(value, index) in niushejihe" :key="index" :value='value.cowshedId'>
						{{value.cowshedNum}}
					  </option> 
					  
				</select> -->
				<el-select v-model="value1" placeholder="请选择" @change="selectchange">
				    <el-option
				            v-for="item in niushejihe"
				            :key="item.cowshedId"
				            :label="item.cowshedNum"
				            :value="item.cowshedId">
				    </el-option>
				</el-select>
              </div>
              <div class="archives_content clearfix" >
                  <p class="content_p">牛栏编号：</p>
                  <el-select v-model="value2" placeholder="请选择" @change="selectchange2">
                      <el-option
                              v-for="item in niulanjihe"
                              :key="item.bullpenNum"
                              :label="item.bullpenNum"
                              :value="item.bullpenNum">
                      </el-option>
                  </el-select>
				
              </div>
              <button class="archives_check_btn2" @click="querys">搜 索</button>
          </div>
		  <div class="archives_list">
		      <el-table
		              :data="tableData"
		  
		              style="width: 100%"
		              :row-class-name="tableRowClassName">
		          <el-table-column
		                  prop="gleb"
		                  align="center"
		                  label="母扣编号"
		          >
		          </el-table-column>
		          <el-table-column
		                  prop="rfid"
		                  align="center"
		                  label="子扣编号"
		          >
		          </el-table-column>
		          <el-table-column
		                  prop="cowshedNum"
		                  align="center"
		                  label="所处牛舍">
		          </el-table-column>
		          <el-table-column
		                  prop="bullpenNum"
		                  align="center"
		                  label="所处牛栏">
		          </el-table-column>
		          <el-table-column
		                  prop="inDate"
		                  align="center"
		                  label="购入日期">
		          </el-table-column>
		      </el-table>
		      <div class="fenye">
		          <el-pagination
		                  @current-change="handleCurrentChange"
		                  :current-page="pageNo"
		                  :page-size="pageSize"
		                  layout="total, prev, pager, next, jumper"
		                  :total=total>
		          </el-pagination>
		      </div>
		  </div>
      </div> 
    </div>
</template>
<script>
  import {findBullpen,findOxer,bullpenInfo} from '@/libs/api'
  import {getCookie} from '@/libs/cookieFun'
  import bus from '@/libs/bus' 
   export default {
      data() {
          return {
			  value1:'选择牛舍',
			  value2:'选择牛栏',
			  tableData:[],
			  total:'0',
			cattlefarmId: "",//牛场id
            niushejihe:[],//牛舍集合 
			niulanjihe:[],
			cowshedId:'',//牛舍iD 
			cowshedNum:'',//牛舍名
			bullpenNum:"",//牛栏名
			 pageNo:1,
			 pageSize:10,
			
          };
      },
      mounted() {
        let self = this
        bus.$on('cattlefarm_Id',(cattlefarm_Id)=>{
            self.cattlefarmId = cattlefarm_Id 
			 self.niushejihess()
			self.niuzhilist()
			 
        });
        if (self.$route.query.id) {
            self.cattlefarmId = self.$route.query.id
			self.niushejihess()
			self.niuzhilist()
			
        };
		
      },
      methods: {
		 querys(){
			let data = {
				cattlefarmId: this.cattlefarmId,
				token: getCookie('token'),
				cowshedId:this.cowshedId,
				bullpenNum:this.bullpenNum,
				pageNo: this.pageNo,
				pageSize: this.pageSize,
			};
			this.$post(bullpenInfo, data).then((res) => {
				this.tableData=res.data.list;
				this.total = res.data.total
			    debugger
				console.log(this.tableData)
			})	  
		 },
        niushejihess(){
			let data = {
				cattlefarmId: this.cattlefarmId,
				token: getCookie('token')
			};
			this.$post(findOxer, data).then((res) => {
				this.niushejihe=res.data;
				
			   // debugger
				//console.log(this.niushejihe)
			})	 
       },
	   niulanjihess(id){
		  // debugger
  	   		let data = {
  	   		cattlefarmId: this.cattlefarmId,
  	   		token: getCookie('token'),
  	   		cowshedId:id,
  	   	};
  	   	this.$post(findBullpen, data).then((res) => {
  	   		this.niulanjihe=res.data;
			console.log(this.niulanjihe)
  	   	    //debugger
  	   	})	  
  	   			   	
	   },
	   selectchange(val){
		  //console.log(val);
           this.cowshedId = val;
		    //this.cowshedNum = val.cowshedNum;
               //alert(this.cowshedId)
			this.niulanjihess(val)
        },
		 selectchange2(val){
				  //console.log(val);
		    this.bullpenNum = val;
			//debugger
			console.log(val);	
		 },
		niuzhilist(){
			let data = {
				cattlefarmId: this.cattlefarmId,
				token: getCookie('token'),
				cowshedId:this.cowshedId,
				bullpenNum:this.bullpenNum,
				pageNo: this.pageNo,
				pageSize: this.pageSize,
			};
			this.$post(bullpenInfo, data).then((res) => {
				this.tableData=res.data.list;
				this.total = res.data.total
			    //debugger
				//console.log(this.tableData)
			})	  
		},
		 tableRowClassName({row, rowIndex}) {
		    if (rowIndex % 2 === 0) {
		        return 'warning-row';
		    }
		    return '';
		},
         handleCurrentChange(val) {
           let data = {
           	cattlefarmId: this.cattlefarmId,
           	token: getCookie('token'),
           	cowshedId:this.cowshedId,
           	bullpenNum:this.bullpenNum,
           	pageNo: val,
           	pageSize: this.pageSize,
           };
            this.$post(bullpenInfo, data).then((res) => {
            	this.tableData=res.data.list;
            	this.total = res.data.total
                //debugger
            	//console.log(this.tableData)
            })	  
        }, 
         
     },
  };
</script>
<style scoped>
    @import "../../css/base.css";
  
  .archives {
      width: 98%;
      background: rgba(0, 0, 0, 0.10);
      border: 1px solid #2294C9;
      margin: 30px auto;
      position: relative;
      padding-bottom: 30px;
  
  }
  
  .yanse {
      color: #5C9BF9;
  }
  
  .top_left {
      display: block;
      width: 8px;
      height: 8px;
      border-bottom: 1px solid #1DE8F5;
      border-right: 1px solid #1DE8F5;
      position: absolute;
      bottom: 0;
      right: 0;
  }
  
  .top_left2 {
      display: block;: 8 px;
      height: 8px;
      border-bottom: 1px solid #1DE8F5;
      border-left: 1px solid #1DE8F5;
      position: absolute;
      bottom: 0;
      left: 0;
  }
  
  .top_left3 {
      display: block;
      width: 8px;
      height: 8px;
      border-top: 1px solid #1DE8F5;
      border-left: 1px solid #1DE8F5;
      position: absolute;
      top: 0;
      left: 0;
  }
  
  .top_left4 {
      display: block;
      width: 8px;
      height: 8px;
      border-top: 1px solid #1DE8F5;
      border-right: 1px solid #1DE8F5;
      position: absolute;
      top: 0;
      right: 0;
  }
  
  .archives_check {
      width: 98%;
      height: 98%;
      margin: 30px auto 0;
  }
  
  .archives_check_p {
      width: 150px;
      height: 40px;
      float: left;
      font-family: MicrosoftYaHei-Bold;
      font-size: 14px;
      color: #1DE8F5;
  }
  
  .archives_check_btn {
      width: 80px;
      height: 36px;
      background: #5C9BF9;
      border-radius: 6px;
      float: right;
      font-family: AvenirNext-Regular;
      font-size: 14px;
      color: #FFFFFF;
      letter-spacing: 0;
      text-align: center;
  }
  
  .archives_content {
      width: 250px;
      height: 30px;
      float: left;
  }
  
  .archives_content2 {
      width: 400px;
      height: 30px;
      float: left;
  }
  
  .content_p {
      width: 80px;
      height: 30px;
      line-height: 30px;
      float: left;
      font-family: MicrosoftYaHei;
      font-size: 12px;
      color: #FFFFFF;
      padding-right: 10px;
  
  }
  
  .content_input {
      width: 150px;
      height: 30px;
      line-height: 30px;
      float: left;
      font-family: MicrosoftYaHei;
      font-size: 12px;
      color: #FFFFFF;
      background: #0A3A78;
      border: 1px solid #5C9BF9;
      border-radius: 3px;
      padding-left: 5px;
  }
  .el-select{
      width: 150px;
      height: 30px;
      line-height: 30px;
      float: left;
      font-family: MicrosoftYaHei;
      font-size: 12px;
      color: #FFFFFF;
      background: #0A3A78;
      border: 1px solid #5C9BF9;
      border-radius: 3px;
      padding-left: 5px;
  }
  .el-select>>>.el-input__inner{
	  
	 line-height: 28px;
	height: 26px;
	 font-family: MicrosoftYaHei;
	 font-size: 12px;
	 color: #FFFFFF;
	 background: #0A3A78;
	 border: none;
	 
  }
  input::-webkit-input-placeholder {
      color: #fff;
  }
  
  .el-date-editor {
      background: #0A3A78;
      width: 150px;
      border: 1px solid #5C9BF9;
  }
  
  .el-range-input {
      background: #0A3A78;
  }
  
  .el-date-editor .el-input__icon {
      width: 16px;
      height: 16px;
      margin-top: 0px;
  }
  
  .el-date-editor .el-range-separator {
      padding: 0 5px;
      line-height: 21px;
      width: 5%;
      color: #fff;
  }
  
  .el-date-editor .el-range-input {
  
      color: #fff;
  }
  
  .archives_check_btn2 {
      width: 80px;
      height: 36px;
      line-height: 36px;
      background: #F5A623;
      border-radius: 6px;
      font-size: 14px;
      color: #FFFFFF;
      letter-spacing: 0;
      text-align: center;
      float: left;
      margin-left: 30px;
      margin-top: -3px;
  }
  
  .archives_list {
      width: 100%;
      margin-top: 30px;
      border-top: 1px solid #2294C9;
  }
  
  .el-table--enable-row-hover .el-table__body tr > td {
      background-color: rgba(34, 148, 201, 0.20);
      border: none;
      color: #fff;
  }
  
  .archives_list >>> .el-table, .archives_list >>> .el-table__expanded-cell {
      background-color: transparent;
  }
  
  .archives_list >>> .el-table th, .archives_list >>> .el-table tr {
      background-color: transparent;
      color: #fff;
  }
  
  .archives_list >>> .el-table--enable-row-hover .el-table__body tr:hover > td {
      background-color: rgba(34, 148, 201, 0.2) !important;
  
  
  }
  
  .archives_list >>> .el-table .warning-row {
      background: rgba(34, 148, 201, 0.1);
      /*opacity: 0.1;*/
  
  }
  
  .el-table--border::after, .el-table--group::after, .el-table::before {
      background-color: transparent;
  }
  
  .archives_list >>> .el-table td, .archives_list >>> .el-table th.is-leaf {
      border-bottom: none;
  }
  
  .el-button:nth-child(1) {
      padding-right: 3px;
      color: #1DE8F5;
  }
  
  .el-button:nth-child(2) {
      padding-right: 3px;
      color: #5C9BF9;
  }
  
  .el-button:nth-child(3) {
      color: #F5A623;
  }
  
  .fenye {
      text-align: center;
      margin-top: 30px;
  }
  
  .archives_list >>> .el-pagination__total {
  
      color: #fff;
  }
  
  .archives_list >>> .el-pagination__jump {
  
      color: #fff;
  }
  
  .archives_list >>> .el-input__inner {
  
      border-radius: 4px;
  
      color: #fff;
  
      background-color: transparent;
      width: 100%;
  }
  
  .archives_list >>> .el-pagination {
  
      color: #fff;
  }
  
  .archives_list >>> .el-pagination .btn-next, .archives_list >>> .el-pagination .btn-prev {
      background: transparent;
      background-size: 16px;
      cursor: pointer;
      margin: 0;
      color: #fff;
  }
  
  .archives_list >>> .el-dialog, .archives_list >>> .el-pager li {
      background: transparent;
  
  }
  
  .el-pagination button:disabled {
      color: #fff;
      background-color: transparent;
  
  } 
</style>
